<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>點點名</title>
    <style type="text/css">
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
    }

    body {
      height: 100%;
    }

    iframe {
      display: block;
      width: 100%;
      height: 100%;
      border: none;
      overflow-y: auto;
      overflow-x: hidden;
    }
  </style>
</head>
<body>
<iframe id="dynamic-iframe" frameborder="0" marginheight="0" marginwidth="0"
width="100%" height="100%" scrolling="auto">
</iframe>
  <script>
  // 替換這個 URL 為您發布的試算表 CSV 連結
  const spreadsheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQTJNmi-NJY8OHeEDzytDmwfNS_cbKnFVdRFi1tlwtvVl9iJMjtGXGffxp2LsEc54_iCDJkVy-lAloV/pub?gid=0&single=true&output=csv';

  fetch(spreadsheetUrl)
    .then(response => response.text())
    .then(data => {
      const rows = data.split('\n');
      const headers = rows[0].split(',');
      const dColumnIndex = headers.findIndex(header => header.trim().toUpperCase() === 'D');
      
      if (dColumnIndex !== -1 && rows.length > 2) {
        const cells = rows[2].split(',');
        if (cells.length > dColumnIndex) {
          const url = cells[dColumnIndex].trim(); // D3 單元格
          document.getElementById('dynamic-iframe').src = url;
        } else {
          console.error('D3 單元格不存在');
        }
      } else {
        console.error('找不到 D 列或試算表沒有足夠的行');
      }
    })
    .catch(error => console.error('獲取試算表數據時出錯:', error));
</script>

</body>

</html>
